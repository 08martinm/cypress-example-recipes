language: node_js
node_js:
- 6.5.0

cache:
  directories:
    - node_modules

# hmm, do we need these commands if we are running using build stages?
script: echo "Running tests against $(node -v) ..."
script: npm install
script: npm prune

defaults: &defaults
  script:
    - cd examples/$DIR
    - echo current dir $PWD
    - npm start -- --silent &
    - npm run cypress:run -- --record

jobs:
  include:
    # define a separate script for each "examples/*" folder
    # this will run it in a separate job on TravisCI

    - stage: test
      env:
        - DIR=blogs__codepen-demo
      <<: *defaults
    - stage: test
      env:
        - DIR=blogs__direct-control-angular
      <<: *defaults
    - stage: test
      env:
        - DIR=blogs__e2e-api-testing
      <<: *defaults

    # - script:
    #   - cd examples/blogs__direct-control-angular
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/blogs__e2e-api-testing
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/blogs__e2e-snapshots
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/blogs__vue-vuex-rest
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record

    # # assertions and modules
    # - script:
    #   - cd examples/extending-cypress__chai-assertions
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/fundamentals__node-modules
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record

    # # different ways of logging in
    # - script:
    #   - cd examples/logging-in__csrf-tokens
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/logging-in__html-web-forms
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/logging-in__single-sign-on
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/logging-in__xhr-web-forms
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record

    # # preprocessor examples
    # - script:
    #   - cd examples/preprocessors__typescript-browserify
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/preprocessors__typescript-webpack
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record

    # # misc
    # - script:
    #   - cd examples/server-communication__bootstrapping-your-app
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record

    # # stubbing and spying
    # - script:
    #   - cd examples/stubbing-spying__functions
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/stubbing-spying__window-fetch
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record

    # # testing DOM
    # - script:
    #   - cd examples/testing-dom__drag-drop
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/testing-dom__form-interactions
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/testing-dom__hover-hidden-elements
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/testing-dom__tab-handling-links
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record

    # # unit testing examples
    # - script:
    #   - cd examples/unit-testing__application-code
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record
    # - script:
    #   - cd examples/unit-testing__react-enzyme
    #   - echo current dir $PWD
    #   - npm start -- --silent &
    #   - npm run cypress:run -- --record

notifications:
  slack:
    secure: ne0CixoRITDhePGEGgxDYnwB7DxoMhuFO6NWJKqgzs6Cz/uwwWJ9DAVgjbbh6HWaWLhHaew0s4Bx3Ckyk2AfqzmrPhVJCWZsx7VihrniGZCn/sZk/VQ71O/XDXlEw2d7Gm65Uu9MtesB98sCQsbr69cAJzZWd4A/6R/7nWsLmzM7KG1ZnEHDhNFI5KY/dAA7ImZ7q9pc5Zw1JeAMW7X4nGpDRhXcxk2FxVNge5m4GOhlFfb/CPNwo/FC9MbE+GrfpyQNK5J0DRkdu7igs8dbTJFEEjGLCVbxLZD5X5GZwRJmN3G5Zt89bs/ZHwj4tBKWKZeSxEbrrOr/OilFF3N46QhJSTjF7DgG2BlITYi3ZgHSUC/OanfxjoGYMrd702Nq9Wod3ZbhiwTbAwBOkkfv9+g12fwTk+u5BgNhcweHbdP3Ju5dmD53Z7rY4kIP0XlhfvU5WvC6YuKzVxquZQFEAWYzkcBPiZh2UP9hxuBRdX5UcLoU2eBGAUa8LlPhMO15i5sXyfH1vjnKkzgf1n8I7RQcWvpTBnAZyLwjT4bnqwP7gBYt/heO+iSGVaIya3ShtocwBxv9l88Qe6ogsHAHLnjaK352hVc5+6s7WyECXQ2EZug8GXlahHkLn3dXEY+zVNclyG0rNSDMRDQO5LsrXVr7zjyxHHrEWWBvHfePfb0=
